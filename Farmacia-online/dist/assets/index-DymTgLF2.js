(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function d(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(e){if(e.ep)return;e.ep=!0;const o=d(e);fetch(e.href,o)}})();console.log("Bem-vindo ao JavaScript da sua Farmácia Online!");console.log("Conectando ao backend...");const u="http://localhost:3000";document.addEventListener("DOMContentLoaded",()=>{const s=document.querySelector("#banner-promocional button"),c=document.querySelector("#produtos");s&&c&&s.addEventListener("click",()=>{c.scrollIntoView({behavior:"smooth"})});async function d(){const o=document.querySelector(".lista-produtos");if(!o){console.error("Elemento .lista-produtos não encontrado.");return}o.innerHTML="Carregando produtos...";try{const r=await fetch(`${u}/api/products`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=await r.json();o.innerHTML="",a.length===0?o.innerHTML="<p>Nenhum produto encontrado no momento. Adicione produtos no seu Supabase!</p>":a.forEach(n=>{const t=document.createElement("div");t.classList.add("produto-card"),t.innerHTML=`
                        <img src="${n.imagem_url||"placeholder.jpg"}" alt="${n.nome}" style="width:100%; max-width:150px; height:auto; margin-bottom: 10px; border-radius: 5px;">
                        <h3>${n.nome}</h3>
                        <p>${n.descricao||"Produto de alta qualidade para a sua saúde."}</p>
                        <p class="preco">R$ ${n.preco?n.preco.toFixed(2).replace(".",","):"N/A"}</p>
                        <button class="adicionar-carrinho" data-id="${n.id}">Adicionar ao Carrinho</button>
                    `,o.appendChild(t)}),i()}catch(r){console.error("Erro ao buscar produtos:",r),o.innerHTML="<p>Erro ao carregar produtos. Por favor, tente novamente mais tarde.</p>"}}function i(){const o=document.querySelectorAll(".adicionar-carrinho"),r=document.querySelector('header nav ul li a[href="#carrinho"]');let a=parseInt(localStorage.getItem("cartCount")||"0",10);r&&(r.innerText=`Carrinho (${a})`),o.forEach(t=>{t.removeEventListener("click",n),t.addEventListener("click",n)});function n(t){const m=t.target.dataset.id,l=t.target.parentNode.querySelector("h3").innerText;a++,localStorage.setItem("cartCount",a),r&&(r.innerText=`Carrinho (${a})`),console.log(`Produto "${l}" (ID: ${m}) adicionado ao carrinho!`),alert(`"${l}" adicionado ao carrinho! Total: ${a} itens.`)}}const e=document.querySelector("#contato form");e&&e.addEventListener("submit",async o=>{o.preventDefault();const r=e.querySelector('input[type="text"]').value,a=e.querySelector('input[type="email"]').value,n=e.querySelector("textarea").value;if(r&&a&&n){console.log("Tentando enviar mensagem...");try{const t=await fetch(`${u}/api/contact`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nome:r,email:a,mensagem:n})});if(t.ok)alert("Sua mensagem foi enviada com sucesso! Em breve entraremos em contato."),e.reset();else throw new Error(`Erro ao enviar mensagem: ${t.statusText}`)}catch(t){console.error("Erro ao enviar formulário de contato:",t),alert("03330000")}}else alert("Por favor, preencha todos os campos do formulário.")}),d()});
